<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>認証付きHTMLビューア</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<script>
function getLoginCache(){
  const raw = localStorage.getItem("harutyan-login");
  if(!raw) return null;
  try{
    const data = JSON.parse(raw);
    if(Date.now() > data.expiresAt){
      localStorage.removeItem("harutyan-login");
      return null;
    }
    return data.email;
  }catch{return null;}
}
function b64ToText(b64){
  return decodeURIComponent(escape(atob(b64)));
}
const EMBED_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8bWV0YSBodHRwLWVxdWl2PSJYLVVBLUNvbXBhdGlibGUiIGNvbnRlbnQ9ImllPWVkZ2UiPgogICAgPHRpdGxlPk1pbmVzd2VlcGVyPC90aXRsZT4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iY3NzL21haW4uY3NzIj4KICAgIDxzY3JpcHQKICAgIHNyYz0iaHR0cHM6Ly9jb2RlLmpxdWVyeS5jb20vanF1ZXJ5LTMuMi4xLm1pbi5qcyIKICAgIGludGVncml0eT0ic2hhMjU2LWh3ZzRnc3hnRlpoT3NFRWFtZE9ZR0JmMTNGeVF1aVR3bEFRZ3hWU05ndDQ9IgogICAgY3Jvc3NvcmlnaW49ImFub255bW91cyI+PC9zY3JpcHQ+CjwvaGVhZD4KPGJvZHk+ICAgCiAgICA8ZGl2IGNsYXNzPSJmbGV4LWNvbnRhaW5lciI+CiAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1ib2FyZCI+CiAgICAgICAgICAgIDxicj4KICAgICAgICAgICAgICAgIDx0YWJsZSBpZD0iYm9hcmQiPjwvdGFibGU+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICAgICAgICA8c2VjdGlvbiBpZD0iZm9vdGVyIj4KICAgICAgICAgICAgPGRpdiBpZD0ic3RhcnQiPjxpbWcgc3JjPSJpbWFnZXMvc3RhcnQucG5nIj48L2Rpdj4KICAgICAgICAgICAgPGRpdiBpZD0ic2l6ZS1idG5zIj4KICAgICAgICAgICAgICAgIDxkaXYgaWQ9InNpemUtYnRucyI+PGJ1dHRvbiBpZD0ic2l6ZS05Ij48aW1nIHNyYz0iaW1hZ2VzL2Vhc3kucG5nIj4gRWFzeTwvYnV0dG9uPjwvZGl2PiAKICAgICAgICAgICAgICAgIDxkaXYgaWQ9InNpemUtYnRucyI+PGJ1dHRvbiBpZD0ic2l6ZS0xNiI+PGltZyBzcmM9ImltYWdlcy9tZWRpdW0ucG5nIj4gTWVkaXVtPC9idXR0b24+PC9kaXY+IAogICAgICAgICAgICAgICAgPGRpdiBpZD0ic2l6ZS1idG5zIj48YnV0dG9uIGlkPSJzaXplLTMwIj48aW1nIHNyYz0iaW1hZ2VzL2hhcmQucG5nIj4gSGFyZDwvYnV0dG9uPjwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBpZD0iY2xvY2siPjxlbT4iU2hpZnQgKyBDbGljayI8L2VtPjwvc3Ryb25nPiB0byB0b2dnbGUgPGltZyBzcmM9ImltYWdlcy9mbGFnLnBuZyI+PC9kaXY+CiAgICAgICAgPC9zZWN0aW9uPgogICAgPHNjcmlwdCBzcmM9ImpzL2NlbGwuanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9ImpzL21haW4uanMiPjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4=";
(function init(){
  const cached = getLoginCache();
  if(cached){
    // ログイン済みなら埋め込みHTMLを復号して表示
    const html = b64ToText(EMBED_B64);
    document.open();
    document.write(html);
    document.close();
  }else{
    // 未ログインなら login.html にリダイレクト
    location.href = "login.html";
  }
})();
</script>
</body>
</html>